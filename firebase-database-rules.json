
{
  "rules": {
    ".read": true,
    ".write": true,
    "ScannedIDs": {
      "$rfid": {
        ".validate": "newData.hasChildren(['timestamp', 'processed']) && $rfid.matches(/^[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}$/)",
        "timestamp": {
          ".validate": "newData.isNumber() && newData.val() > 0"
        },
        "processed": {
          ".validate": "newData.isBoolean()"
        }
      }
    },
    "students": {
      ".indexOn": ["rfid", "name", "email"],
      "$studentId": {
        ".validate": "newData.hasChildren(['name', 'rfid', 'email', 'course', 'year', 'section']) && $studentId.matches(/^TA[0-9]{9}$/)",
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 100"
        },
        "rfid": {
          ".validate": "newData.isString() && newData.val().matches(/^[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}:[A-Fa-f0-9]{2}$/) && !root.child('students').hasChild(newData.val())"
        },
        "email": {
          ".validate": "newData.isString() && newData.val().contains('@') && newData.val().length <= 100"
        },
        "course": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 50"
        },
        "year": {
          ".validate": "newData.isString() && newData.val().matches(/^[1-4](st|nd|rd|th) Year$/)"
        },
        "section": {
          ".validate": "newData.isString() && newData.val().matches(/^[A-Z]$/) && newData.val().length === 1"
        }
      }
    },
    "adminUsers": {
      ".indexOn": ["email"],
      "$adminId": {
        ".validate": "newData.hasChildren(['name', 'password', 'role', 'email']) && $adminId.matches(/^ICCTADMIN[0-9]{2}$/)",
        "password": {
          ".validate": "newData.isString() && newData.val().length >= 6 && newData.val().length <= 50"
        },
        "name": {
          ".validate": "newData.isString() && newData.val().length > 0 && newData.val().length <= 100"
        },
        "role": {
          ".validate": "newData.isString() && (newData.val() === 'Administrator' || newData.val() === 'Supervisor')"
        },
        "email": {
          ".validate": "newData.isString() && newData.val().contains('@') && newData.val().length <= 100"
        }
      }
    },
    "attendanceRecords": {
      ".indexOn": ["status"],
      "$studentId": {
        ".validate": "root.child('students').child($studentId).exists()",
        "$date": {
          ".validate": "newData.hasChild('status') && $date.matches(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/)",
          "status": {
            ".validate": "newData.isString() && (newData.val() === 'present' || newData.val() === 'absent' || newData.val() === 'late')"
          },
          "timeIn": {
            ".validate": "(newData.isString() && newData.val().matches(/^[0-9]{2}:[0-9]{2}$/)) || !newData.exists()"
          },
          "timeOut": {
            ".validate": "(newData.isString() && newData.val().matches(/^[0-9]{2}:[0-9]{2}$/)) || !newData.exists()"
          }
        }
      }
    },
    "schedules": {
      "$studentId": {
        ".validate": "root.child('students').child($studentId).exists()",
        "$day": {
          ".validate": "($day === 'monday' || $day === 'tuesday' || $day === 'wednesday' || $day === 'thursday' || $day === 'friday') && (newData.val() === null || newData.val().length >= 0)"
        }
      }
    },
    "absenteeAlerts": {
      "$date": {
        ".validate": "$date.matches(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/) && (newData.val() === null || newData.val().length >= 0)"
      }
    }
  }
}
